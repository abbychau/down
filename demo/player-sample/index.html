<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<title>Player Sample</title>
		<script src="../../client/oekaki-chat.js"></script>
		<script src="js/jquery-1.9.0.js"></script>
		<script src="js/socket.io.js"></script>
		<style>
			div#oekaki-chat {
				border-color: #269CE9;
				background-color: #269CE9;
				color: #EEEEEE;
				border-radius: 10px;
				width: 340px;
				height: 280px;
				padding: 5px 5px 5px;
				font-size: 18px;
			}
			canvas#oekaki-chat-canvas {
				background-color: #EEEEEE;
				width: 320px;
				height: 240px;
				margin-left: 10px;
			}
		</style>
		<script>
			$(function(){
				// canvas要素のノードオブジェクト
				var canvas = $('#oekaki-chat-canvas')[0];
				var ctx = canvas.getContext('2d');

				function drawBackground() {
					ctx.fillStyle = 'rgb(255, 255, 255)';
					ctx.fillRect(0,0,canvas.width,canvas.height);
				};

				function drawLine(prev,next,config) {
					ctx.lineJoin = "round";
					ctx.lineCap = "round";
					ctx.strokeStyle = config.color;
					ctx.lineWidth = config.size;
					ctx.beginPath();
					ctx.moveTo(prev.x, prev.y);
					ctx.lineTo(next.x, next.y);
					ctx.stroke();
					ctx.closePath();
				}

				function drawStrokes(config,strokes,scale) {
					if(strokes.length<=0) return;
					ctx.lineJoin = "round";
					ctx.lineCap = "round";
					ctx.strokeStyle = config.color;
					ctx.lineWidth = config.size*scale;
					ctx.beginPath();
					ctx.moveTo(strokes[0].x*scale, strokes[0].y*scale);
					for (var i = 1; i < strokes.length; i++) {
						ctx.lineTo(strokes[i].x*scale, strokes[i].y*scale);
					}
					ctx.stroke();
					ctx.closePath();
				}

				var oekaki = new OekakiClient('http://localhost:9001')
				oekaki.receiveAllStroke(function(data){
					$('#oekaki-chat-label').html(data.name);
					for (var i = 0; i < data.stroke.length; i++) {
						var st = data.stroke[i];
						drawStrokes(st.config,st.strokes,9/16);
					};
				});
			});
		</script>
	</head>
	<body style="background-color:rgb(235, 235, 235);">
		<h2>ブログパーツ</h2>
		<div id="oekaki-chat">
			<div id="oekaki-chat-label"></div>
			<canvas id="oekaki-chat-canvas"></canvas>
		</div>
	</body>
</html>
